<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Firebase Firestore Example</title>
    <script src="./src/videoListJson.js"></script>
    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.0/firebase-app.js";
        import { getDatabase, ref, get, set, child } from "https://www.gstatic.com/firebasejs/10.13.0/firebase-database.js";

        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyANXqoQVtzyTx469UPHdHgwXvgumrPn60s",
            authDomain: "datalink-4b158.firebaseapp.com",
            databaseURL: "https://datalink-4b158-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "datalink-4b158",
            storageBucket: "datalink-4b158.appspot.com",
            messagingSenderId: "256520884267",
            appId: "1:256520884267:web:4635bbcb2c7100dab71a6e",
            measurementId: "G-6NJ4XFE99L"
        };

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);

        // ------------------GET-------------------

        async function getDataBase(path, key, type) {
            try {
                const snapshot = await get(child(ref(db), path));
                if (snapshot.exists()) {
                    const data = snapshot.val();
                    if (type) {
                        return Object.keys(data).length;
                    } else {
                        return data[key];
                    }
                } else {
                    console.log("No data available");
                    return null;
                }
            } catch (error) {
                console.error(error);
                return null;
            }
        }


        async function fetchData() {
            const count = await getDataBase('/data/videoLink', '', 1);
            console.log(count);

            const url = await getDataBase('/data/videoLink/v1', 'url', 0);
            console.log(url);
        }

        fetchData();



        // -------------------SET-------------------

        async function setDataBase(path, value) {
            set(ref(db, path), value)
                .then(() => {
                    console.log("Object written successfully!");
                })
                .catch((error) => {
                    console.error("Error writing object:", error);
                });
        }

        // for (let i = 0; i < videoListJson.length; i++) {
        //     set(ref(db, `/data/videoLink/v${i}`), videoListJson[i])
        //         .then(() => {
        //             console.log("Object written successfully!");
        //         })
        //         .catch((error) => {
        //             console.error("Error writing object:", error);
        //         });
        // }

        // const videoLinkObject = {
        //     'url': '1wyyuJ2iSDZshoFtgeb-3dP4nLR1Fy9QJ',
        //     'title': 'Ron is.Gone.Wrong.2021.ViE.DUB.mHD.BluRay.DD5.1.x264-c0kE',
        //     'content': 'def',
        //     'view': 0
        // };

        // console.log(videoListJson[1])

    </script>

</head>

<body>
</body>

</html>